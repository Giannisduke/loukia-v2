jQuery(document).ready(function(a){"use strict";a.wc_additional_variation_images_admin={getVariationIDs:function(){var b=[];return a.each(a("#variable_product_options .woocommerce_variation"),function(){b.push(a(this).find(".upload_image .upload_image_button").prop("rel"))}),b},runSortable:function(){a.each(a("#variable_product_options .woocommerce_variation"),function(){var b=a(this).find("a.upload_image_button").prop("rel");a(this).find("ul.wc-additional-variations-images-list").sortable({update:function(){a.wc_additional_variation_images_admin.prepThumbs(b)},placeholder:"sortable-placeholder",cursor:"move"})})},prepThumbs:function(b){if(!(b.length<=0)){var c=[],d=a('#variable_product_options .woocommerce_variation a.upload_image_button[rel="'+b+'"]').parent(".upload_image");d.find("ul.wc-additional-variations-images-list li").length?(a.each(d.find("ul.wc-additional-variations-images-list li"),function(){c.push(a(this).find("a.wc-additional-variations-images-thumb").data("id"))}),d.find("input.wc-additional-variations-images-thumbs-save").val(c)):d.find("input.wc-additional-variations-images-thumbs-save").val(""),c.join(","),a("#variable_product_options").find("input").eq(0).change(),d.parents(".woocommerce_variation").eq(0).addClass("variation-needs-update")}},init:function(){var b=wc_additional_variation_images_local,c={action:"wc_additional_variation_images_load_images_ajax",ajaxAdminLoadImageNonce:wc_additional_variation_images_local.ajaxAdminLoadImageNonce,variation_ids:a.wc_additional_variation_images_admin.getVariationIDs()};a.wc_additional_variation_images_admin.getVariationIDs().length&&a.post(wc_additional_variation_images_local.ajaxurl,c,function(c){for(var d in c.images)if(c.images.hasOwnProperty(d)){var e='<h4 class="wc-additional-variation-images-title">'+b.adminTitleText+' <a href="#" class="wc-additional-variations-images-tip" data-tip="'+b.adminAddImagesTip+'">[?]</a></h4>'+c.images[d]+'<a href="#" class="add-additional-images">'+b.adminAddImagesText+"</a>";a('#variable_product_options .woocommerce_variation a.upload_image_button[rel="'+d+'"]').parents(".upload_image").find("a.wc-additional-variations-images-tip").length||a('#variable_product_options .woocommerce_variation a.upload_image_button[rel="'+d+'"]').after(e)}a(".wc-additional-variations-images-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50}),a.wc_additional_variation_images_admin.runSortable()}),a("#variable_product_options .woocommerce_variation").on("click","a.add-additional-images",function(c){c.preventDefault();var d,e=a(this).parents(".upload_image").find("a.upload_image_button").prop("rel"),f=a(this).parents(".upload_image").find("ul.wc-additional-variations-images-list");d=wp.media.frames.mediaFrame=wp.media({title:b.adminMediaTitle,button:{text:b.adminMediaAddImageText},library:{type:"image"},multiple:!0}),d.on("select",function(){var b=d.state().get("selection");b.map(function(a){if(a=a.toJSON(),a.id){var b=a.sizes.thumbnail?a.sizes.thumbnail.url:a.url;wc_additional_variation_images_local.is23?f.append('<li><a href="#" class="wc-additional-variations-images-thumb" data-id="'+a.id+'"><img src="'+b+'" /><span class="overlay"></span></a></li>'):f.append('<li><a href="#" class="wc-additional-variations-images-thumb" data-id="'+a.id+'"><img src="'+b+'" width="40" height="40" /><span class="overlay"></span></a></li>')}}),wp.media.model.settings.post.id=e,a.wc_additional_variation_images_admin.runSortable(),a.wc_additional_variation_images_admin.prepThumbs(e)}),d.open()}),a("#variable_product_options .woocommerce_variation").on("click","a.wc-additional-variations-images-thumb",function(b){b.preventDefault();var c=a(this).parents(".upload_image").find("a.upload_image_button").prop("rel");a(this).parent("li").remove(),a.wc_additional_variation_images_admin.prepThumbs(c)})}},a.wc_additional_variation_images_admin.init(),a("body").on("woocommerce_variations_added woocommerce_variations_loaded",function(){a.wc_additional_variation_images_admin.init()})});